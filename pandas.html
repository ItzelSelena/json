import pandas as pd

ruta_archivo = 'tu_archivo.txt'

# Lee las primeras líneas para determinar el número de columnas y sus nombres
with open(ruta_archivo, 'r', encoding='utf-8') as archivo:
    # Lee las primeras 5 líneas (ajusta según sea necesario)
    primeras_lineas = [archivo.readline().strip() for _ in range(5)]

# Combina las primeras líneas para analizar el delimitador y determinar los nombres de las columnas
contenido_inicial = '\n'.join(primeras_lineas)
columnas = pd.read_csv(pd.compat.StringIO(contenido_inicial), sep='\t').columns

# Lee el resto de los datos utilizando Pandas
data = pd.read_csv(ruta_archivo, delimiter='\t', names=columnas, skiprows=5)  # Ajusta skiprows según sea necesario

# Ahora 'data' contiene tus datos organizados por columnas




import pandas as pd
from io import StringIO

ruta_archivo = 'tu_archivo.txt'

# Lee las primeras líneas para determinar el número de columnas y sus nombres
with open(ruta_archivo, 'r', encoding='utf-8') as archivo:
    # Lee las primeras 5 líneas (ajusta según sea necesario)
    primeras_lineas = [archivo.readline().strip() for _ in range(5)]

# Combina las primeras líneas para analizar el delimitador y determinar los nombres de las columnas
contenido_inicial = '\n'.join(primeras_lineas)
columnas = pd.read_csv(StringIO(contenido_inicial), sep='\t').columns

# Lee el resto de los datos utilizando Pandas
data = pd.read_csv(ruta_archivo, delimiter='\t', names=columnas, skiprows=5)  # Ajusta skiprows según sea necesario

# Ahora 'data' contiene tus datos organizados por columnas





def guardar_datos_en_csv(data, ruta_salida_csv):
    # Guarda el DataFrame en un archivo CSV
    data.to_csv(ruta_salida_csv, index=False)
    print(f"\nDatos guardados en {ruta_salida_csv}")

# Uso de las funciones
ruta_archivo = 'tu_archivo.txt'
ruta_salida_csv = 'datos_procesados.csv'

datos = cargar_datos_desde_archivo(ruta_archivo)
guardar_datos_en_csv(datos, ruta_salida_csv)


CREATE FUNCTION buscar_fila_con_valor
(
    @tabla NVARCHAR(255) = 'empleados',
    @valor_buscado NVARCHAR(MAX)
)
RETURNS TABLE
AS
RETURN
(
    DECLARE @sql NVARCHAR(MAX);

    SET @sql = 'SELECT * FROM ' + QUOTENAME(@tabla) + ' WHERE COALESCE(columna1, columna2, columna3, columna4, columna5, columna6, columna7, columna8, columna9, columna10) = @valor_buscado';

    EXEC sp_executesql @sql, N'@valor_buscado NVARCHAR(MAX)', @valor_buscado;
);
