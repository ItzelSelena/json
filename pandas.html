import pandas as pd

ruta_archivo = 'tu_archivo.txt'

# Lee las primeras líneas para determinar el número de columnas y sus nombres
with open(ruta_archivo, 'r', encoding='utf-8') as archivo:
    # Lee las primeras 5 líneas (ajusta según sea necesario)
    primeras_lineas = [archivo.readline().strip() for _ in range(5)]

# Combina las primeras líneas para analizar el delimitador y determinar los nombres de las columnas
contenido_inicial = '\n'.join(primeras_lineas)
columnas = pd.read_csv(pd.compat.StringIO(contenido_inicial), sep='\t').columns

# Lee el resto de los datos utilizando Pandas
data = pd.read_csv(ruta_archivo, delimiter='\t', names=columnas, skiprows=5)  # Ajusta skiprows según sea necesario

# Ahora 'data' contiene tus datos organizados por columnas




import pandas as pd
from io import StringIO

ruta_archivo = 'tu_archivo.txt'

# Lee las primeras líneas para determinar el número de columnas y sus nombres
with open(ruta_archivo, 'r', encoding='utf-8') as archivo:
    # Lee las primeras 5 líneas (ajusta según sea necesario)
    primeras_lineas = [archivo.readline().strip() for _ in range(5)]

# Combina las primeras líneas para analizar el delimitador y determinar los nombres de las columnas
contenido_inicial = '\n'.join(primeras_lineas)
columnas = pd.read_csv(StringIO(contenido_inicial), sep='\t').columns

# Lee el resto de los datos utilizando Pandas
data = pd.read_csv(ruta_archivo, delimiter='\t', names=columnas, skiprows=5)  # Ajusta skiprows según sea necesario

# Ahora 'data' contiene tus datos organizados por columnas





def guardar_datos_en_csv(data, ruta_salida_csv):
    # Guarda el DataFrame en un archivo CSV
    data.to_csv(ruta_salida_csv, index=False)
    print(f"\nDatos guardados en {ruta_salida_csv}")

# Uso de las funciones
ruta_archivo = 'tu_archivo.txt'
ruta_salida_csv = 'datos_procesados.csv'

datos = cargar_datos_desde_archivo(ruta_archivo)
guardar_datos_en_csv(datos, ruta_salida_csv)





CREATE FUNCTION buscar_fila_con_valor(mi_valor VARCHAR) RETURNS TABLE AS $$

DECLARE
    resultado TABLE;
    columna_actual VARCHAR;
BEGIN
    -- Crea una tabla temporal para almacenar el resultado
    CREATE TEMPORARY TABLE resultado_table AS
    SELECT * FROM mi_tabla WHERE 1 = 0;

    -- Itera sobre cada columna de la tabla
    FOR columna_actual IN (SELECT column_name FROM information_schema.columns WHERE table_name = 'mi_tabla') LOOP
        -- Verifica si la columna tiene valores diferentes de NULL (NA)
        EXECUTE 'INSERT INTO resultado_table SELECT * FROM mi_tabla WHERE ' || columna_actual || ' = $1 AND ' || columna_actual || ' IS NOT NULL' USING mi_valor;
    END LOOP;

    -- Retorna el resultado
    RETURN QUERY SELECT * FROM resultado_table;

END;

$$ LANGUAGE plpgsql;
